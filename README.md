# douban-tools

This project includes some scripts for personal usage with [douban](https://www.douban.com/).

## File list

- backup-douban.py : backup douban statuses(广播). Only support statuses in this version.
- *cacert.pem* : CA certificates extracted from Mozilla. Copied from [cURL website](https://curl.haxx.se/docs/caextract.html).
- *douban-cookies.txt* : an example empty cookie file. Export your own cookie file using Firefox add-on `Advanced Cookie Manager` or something like this.
- parse-statuses.py : parse and reformat douban statuses files generated by `backup-douban.py`.

## Instruction

0. Prerequisite
  1. These python scripts need [Python](https://www.python.org/) 3.2+ (3.2-3.4 are supposed to be OK but only 3.5 has been actually tested).
  2. `backup-douban.py` needs [PycURL](http://pycurl.io/). After installing Python, execute `pip install pycurl` to install PycURL.
  3. Download douban-tools as zip and extract into a folder.

1. Export cookies for domain `douban.com` (sub-domains cookies are not necessary) into a text file as *douban-cookies.txt*.
2. Backup douban statuses.
  1. Initial backup: execute `backup-douban.py doubaner_id 1-1000` to backup all historical statuses.
  2. Incremental backup: estimate new statuses pages after last backup and specify suitable page range to backup.
  3. All statuses files will be saved in folder `./doubaner_id/statuses/` with filename like `79839569-001.html`. Newer date and smaller page number will be sorted to the front.
3. Parse statuses.
  1. Execute `parse-statuses.py doubaner_id` to parse statuses files. These statuses files will be parsed in dictionary order of filename. Duplicated statuses in different files will be ignored, so it is OK even if there are overlaps between the statuses files.
  2. Reformatted file will be saved as `./doubaner_id/doubaner_id-statuses-all.html`. This file structure is simple and clear, you can change the CSS style at the file beginning as you like.

## License & Advice

The *cacert.pem* is extracted from Mozilla and licensed under the same license as the Mozilla source file: MPL 2.0

The other python scripts are placed in public domain. You can read, change, and use them in any way. However, it is **not** advised to use `backup-douban.py` on too many douban web-pages too frequently since this would increase the burden of douban.

